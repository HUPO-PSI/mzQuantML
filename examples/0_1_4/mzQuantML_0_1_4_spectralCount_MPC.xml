<!--
example sketch:
- four samples: two "diseased", two "healthy"
- therefore: two MS/MS peak list files (here: .mgf) and two Identification files (here: mzIdentML .mzid)
- included: quant layers for 
  a) "peptide PSM counts" (count all PSMs for each amino acid sequence with modifications, including different charge states)
  b) "raw protein values" (sum of peptide PSM counts for each database sequence)
  c) "normalized protein values" (sum all raw protein counts per assay; divide each raw value by the mean of all assay sums)
  d) "means of groups" (mean of proteins in disease and healthy group)
  e) "ratio" (disease vs. healthy; proteins)

schema comments / issues:
- RawFiles are really the raw files of the instrument run (i.e. .raw, .wiff, .yep, .mzML in profile mode etc.).
  For spectral counting these are unnecessary, as this method only relies on the PSM identifications; 
  even if one wants to include the peak list files (i.e. .mgf, .dta) on which the identifications are based, this is not 
  what is usually described in RawFiles; Therefore <RawFiles> should be optional for spectral counting or renamed to <BaseFiles>, <UsedFiles>, <QuantFiles> etc.
- Listing the spectra used for "peptide PSM count" would correspond to <FeatureList> in the LCMS example; in previous schemas there was a <SpectraSets> element
  with <SpectraSet> sub-elements, shall we include that again as neighbour of <FeatureList>?
- <DataProcessing> is not really clear to me, seems to be rather ambiguous: calculations, that have been done on raw files / peak list files or on mzIdentML files?
  In spectral counting we normalize onto the mean of (the sum of all protein counts per data set within FDR) or similar. Reporting it in <Assay> is a bit "early", 
  but there is no better place at the moment.
- However we need "normalization to mean of proteins" as data processing CV term;
  in psi-ms.obo there is "intensitiy normalization", which should be replaced by
  a new parent term "normalization". "intensity normalization", "normalization to mean of proteins" and "quantile normalization" could be children of this term.
- Allow cvParams under the <Modification> element of <Peptide>.
- Allow ProteinGroups for RowIndex in QuantLayer.
- In <Protein> and <Peptide> there are references to mzIdentML files. At the moment it seems that we have only modeled external references. 
  If also internal references to mzIdentML files listed in <Assay> make sense, we need to add an "id" attribute to <RawFile> and <IdentificationFile>
  for referencing them.

-->

<mzQuantML xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://psidev.info/psi/pi/mzQuantML/0.1 ../../schema/mzQuantML_0_1_4.xsd" xmlns="http://psidev.info/psi/pi/mzQuantML/0.1">
	<cvList>
		<cv id="PSI-MS" fullName="Proteomics Standards Initiative Mass Spectrometry Vocabularies" URI="http://psidev.cvs.sourceforge.net/viewvc/*checkout*/psidev/psi/psi-ms/mzML/controlledVocabulary/psi-ms.obo" version="2.25.0"/>
		<cv id="UO" fullName="Unit Ontology" URI="http://obo.cvs.sourceforge.net/*checkout*/obo/obo/ontology/phenotype/unit.obo"/>
		<cv id="UNIMOD" fullName="unimod modifications ontology" URI="http://www.unimod.org/obo/unimod.obo"/>
	</cvList>
	
	<AssayList id="AL1">
		<Assay id="HEALTHY1">
			<RawFiles>
				<RawFile location="C:\ms\PeakLists\healthy1.mgf"/> <!-- see comment above -->
			</RawFiles>
			<IdentificationFiles>
				<IdentificationFile location="C:\ms\mzIdent\identification1.mzid"/>
			</IdentificationFiles>
			<DataProcessingOrder>
				<DataProcessingOrderElement rank="1" dataProcessing_ref="DP1"/>
			</DataProcessingOrder>
			<cvParam name="one sample data set" accession="MS:1000000" cvRef="PSI-MS"/>
		</Assay>
		<Assay id="HEALTHY2">
			<RawFiles>
				<RawFile location="C:\ms\PeakLists\healthy2.mgf"/> <!-- see comment above -->
			</RawFiles>
			<IdentificationFiles>
				<IdentificationFile location="C:\ms\mzIdent\identification3.mzid"/>
			</IdentificationFiles>
			<DataProcessingOrder>
				<DataProcessingOrderElement rank="1" dataProcessing_ref="DP1"/>
			</DataProcessingOrder>
			<cvParam name="one sample data set" accession="MS:1000000" cvRef="PSI-MS"/>
		</Assay>
		<Assay id="DISEASE1">
			<RawFiles>
				<RawFile location="C:\ms\PeakLists\disease1.mgf"/> <!-- see comment above -->
			</RawFiles>
			<IdentificationFiles>
				<IdentificationFile location="C:\ms\mzIdent\identification2.mzid"/>
			</IdentificationFiles>
			<DataProcessingOrder>
				<DataProcessingOrderElement rank="1" dataProcessing_ref="DP1"/>
			</DataProcessingOrder>
			<cvParam name="one sample data set" accession="MS:1000000" cvRef="PSI-MS"/>
		</Assay>
		<Assay id="DISEASE2">
			<RawFiles>
				<RawFile location="C:\ms\PeakLists\disease2.mgf"/> <!-- see comment above -->
			</RawFiles>
			<IdentificationFiles>
				<IdentificationFile location="C:\ms\mzIdent\identification4.mzid"/>
			</IdentificationFiles>
			<DataProcessingOrder>
				<DataProcessingOrderElement rank="1" dataProcessing_ref="DP1"/>
			</DataProcessingOrder>
			<cvParam name="one sample data set" accession="MS:1000000" cvRef="PSI-MS"/>
		</Assay>
	</AssayList>
	
	<StudyVariableList>
		<StudyVariable id="SV1_HEALTHY" name="healthy group">
			<cvParam accession="MS:1000000" name="experimental condition healthy" cvRef="PSI-MS"/>
			<AssayRef assay_ref="HEALTHY1"/>
			<AssayRef assay_ref="HEALTHY2"/>
		</StudyVariable>
		<StudyVariable id="SV2_DISEASE" name="disease group">
			<cvParam accession="MS:1000000" name="experimental condition disease" cvRef="PSI-MS"/>
			<AssayRef assay_ref="DISEASE1"/>
			<AssayRef assay_ref="DISEASE2"/>
		</StudyVariable>
	</StudyVariableList>

	<ProteinList>
		<QuantLayerRef quantLayer_ref="QL_raw_protein_value_layer"/>
		<QuantLayerRef quantLayer_ref="QL_normalized_protein_value_layer"/>
		<QuantLayerRef quantLayer_ref="QL_protein_means_of_groups"/>
		<QuantLayerRef quantLayer_ref="QL_protein_ratio_disease_vs_healthy"/>
		<Protein accession="YDR238C" id="prot1">
			<IdentificationRef file_ref="file1" id_ref="id1" />
			<PeptideRefs>
				<PeptideRef peptide_ref="pep1"/>
				<PeptideRef peptide_ref="pep2"/>
				
			</PeptideRefs>
		</Protein>
		<Protein accession="XYZ1ABC" id="prot2">
			<IdentificationRef file_ref="file1" id_ref="id2" />
			<PeptideRefs>
				<PeptideRef peptide_ref="pep3"/>
				<PeptideRef peptide_ref="pep4"/>
				<PeptideRef peptide_ref="pep5"/>
			</PeptideRefs>
		</Protein>
		<Protein accession="XYZ123A" id="prot3">
			<IdentificationRef id_ref="id3" file_ref="file1"/>
			<PeptideRefs>
				<PeptideRef peptide_ref="pep5"/>
			</PeptideRefs>
		</Protein>
	</ProteinList>
	<PeptideList>
		<Peptide id="pep1">
			<PeptideSequence>BLAEMLVIS</PeptideSequence>
			<IdentificationRef file_ref="file1" id_ref="id1" />
			<Modification location="5">
				<userParam name="Oxidation" value=""/>
				<!-- better to allow also cvParams here -->
				<!--
				<cvParam accession="UNIMOD:35" name="Oxidation" cvRef="UNIMOD"/>
				-->
			</Modification>
		</Peptide>
		<Peptide id="pep2">
			<PeptideSequence>BLAEMLVISA</PeptideSequence>
			<IdentificationRef file_ref="file2" id_ref="id2"/>
			<Modification location="0">
				<userParam name="Carbamylated residue"/>
				<!-- better to allow also cvParams here -->
				<!--
				<cvParam accession="UNIMOD:5" name="Carbamyl" cvRef="UNIMOD"/>
				-->
			</Modification>
		</Peptide>
		<Peptide id="pep3">
			<PeptideSequence>MLVELVISE</PeptideSequence>
			<IdentificationRef file_ref="file3" id_ref="id3" />
		</Peptide>
		<Peptide id="pep4">
			<PeptideSequence>MLVELVASA</PeptideSequence>
			<IdentificationRef file_ref="file4" id_ref="id4"/>
		</Peptide>
		<Peptide id="pep5">
			<PeptideSequence>MLVELVESA</PeptideSequence>
			<IdentificationRef file_ref="file5" id_ref="id5"/>
		</Peptide>
	</PeptideList>

		<!--	<SpectraSets>
			<SpectraSet id="SPEC_SET_1">
				<PeptideRef peptide_ref="pep1"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_11"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_12"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_13"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_14"/>
			</SpectraSet>
			<SpectraSet id="SPEC_SET_2">
				<PeptideRef peptide_ref="pep2"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_21"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_22"/>
			</SpectraSet>
			<SpectraSet id="SPEC_SET_3">
				<PeptideRef peptide_ref="pep3"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_31"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_32"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_33"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_34"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_35"/>
			</SpectraSet>
			<SpectraSet id="SPEC_SET_4">
				<PeptideRef peptide_ref="pep4"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_41"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_42"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_43"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_44"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_45"/>
				<SpectrumIdentificationItemRef file_ref="mzID_Ref" spectrumIdentificationItem_ref="SII_46"/>
			</SpectraSet>
		</SpectraSets> -->

	<QuantLayerList>
		<!-- description see above a) -->
		<QuantLayer ID="QL_peptide_PSM_count_layer">
			<DataType>
				<cvParam name="raw peptide PSM counts" accession="MS:1000000" cvRef="PSI-MS"/>
			</DataType>
			<RowIndex>pep1 pep2 pep3 pep4 pep5</RowIndex>
			<RowType>
				<cvParam name="Peptides" accession="MS:1000000" cvRef="PSI-MS"/>
			</RowType>
			<ColumnIndex>HEALTHY1 HEALTHY2 DISEASE1 DISEASE2</ColumnIndex>
			<ColumnType>
				<cvParam name="Assay" accession="MS:1000000" cvRef="PSI-MS"/>
			</ColumnType>
			<DataMatrix>
				<Row index="1">1 5 3 10</Row>
				<Row index="2">2 4 4 9</Row>
				<Row index="3">4 3 5 8</Row>
				<Row index="4">5 2 8 7</Row>
				<Row index="5">8 1 9 6</Row>
			</DataMatrix>
		</QuantLayer>

		<!-- description see above b) -->
		<QuantLayer ID="QL_raw_protein_value_layer">
			<DataType>
				<cvParam name="raw protein values" accession="MS:1000000" cvRef="PSI-MS"/>
			</DataType>
			<RowIndex>prot1 prot2 prot3</RowIndex>
			<RowType>
				<cvParam  name="Proteins" accession="MS:1000000" cvRef="PSI-MS"/>
			</RowType>
			<ColumnIndex>HEALTHY1 HEALTHY2 DISEASE1 DISEASE2</ColumnIndex>
			<ColumnType>
				<cvParam name="Assay" accession="MS:1000000" cvRef="PSI-MS"/>
			</ColumnType>
			<DataMatrix>
				<Row index="1">3 9 7 19</Row> 
				<Row index="2">13 6 22 21</Row>
				<Row index="3">8 1 9 6</Row>
			</DataMatrix>
		</QuantLayer>

		<!-- description see above c) -->
		<QuantLayer ID="QL_normalized_protein_value_layer">
			<DataType>
				<cvParam name="normalized protein values" accession="MS:1000000" cvRef="PSI-MS"/>
			</DataType>
			<RowIndex>prot1 prot2 prot3</RowIndex>
			<RowType>
				<cvParam  name="Proteins" accession="MS:1000000" cvRef="PSI-MS"/>
			</RowType>
			<ColumnIndex>HEALTHY1 HEALTHY2 DISEASE1 DISEASE2</ColumnIndex>
			<ColumnType>
				<cvParam name="Assay" accession="MS:1000000" cvRef="PSI-MS"/>
			</ColumnType>
			<DataMatrix>
				<Row index="1">0.097 0.290 0.226 0.613</Row>
				<Row index="2">0.419 0.194 0.710 0.677</Row>
				<Row index="3">0.258 0.032 0.290 0.194</Row>
			</DataMatrix>
		</QuantLayer>

		<!-- description see above d) -->
		<QuantLayer ID="QL_protein_means_of_groups">
			<DataType>
				<cvParam name="mean" accession="MS:100000" cvRef="PSI_MS"/>
			</DataType>
			<RowIndex>prot1 prot2 prot3</RowIndex>
			<RowType>
				<cvParam name="Proteins" accession="MS:100000" cvRef="PSI-MS"/>
			</RowType>
			<ColumnIndex>SV1_HEALTHY SV2_DISEASE</ColumnIndex>
			<ColumnType>
				<cvParam name="StudyVariable" accession="MS:100000" cvRef="PSI-MS"/>
			</ColumnType>
			<DataMatrix>
				<Row index="1">0.1935 0.420</Row>
				<Row index="2">0.307 0.694</Row>
				<Row index="3">0.145 0.242</Row>
			</DataMatrix>
		</QuantLayer>

		<!-- description see above e) -->
		<QuantLayer ID="QL_protein_ratio_disease_vs_healthy">
			<DataType>
				<cvParam name="ratio" accession="MS:100000" cvRef="PSI_MS"/>
			</DataType>
			<RowIndex>prot1 prot2 prot3</RowIndex>
			<RowType>
				<cvParam name="Proteins" accession="MS:100000" cvRef="PSI-MS"/>
			</RowType>
			<ColumnIndex>AL1</ColumnIndex>
			<ColumnType>
				<cvParam name="AssayList" accession="MS:100000" cvRef="PSI-MS"/>
			</ColumnType>
			<DataMatrix>
				<Row index="1">2.171</Row>
				<Row index="2">2.261</Row>
				<Row index="3">1.669</Row>
			</DataMatrix>
		</QuantLayer>

	</QuantLayerList>

	<DataProcessingList>
		<dataProcessing id="DP1">
			<processingMethod>
				<cvParam accession="MS:1000000" name="normalization to mean of proteins" cvRef="PSI-MS"/>
			</processingMethod>
		</dataProcessing>
	</DataProcessingList>
</mzQuantML>
