<!--
Sketch of an example for using data matrices to represent quant layers
-->
<mzQuantML xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://psidev.info/psi/pi/mzQuantML/0.1 ../../schema/mzQuantML_0_1_6.xsd"
 xmlns="http://psidev.info/psi/pi/mzQuantML/0.1">
	<cvList>
		<cv id="PSI-MS" fullName="Proteomics Standards Initiative Mass Spectrometry Vocabularies" URI="http://psidev.cvs.sourceforge.net/viewvc/*checkout*/psidev/psi/psi-ms/mzML/controlledVocabulary/psi-ms.obo" version="2.25.0"/>
		<cv id="UO" fullName="Unit Ontology" URI="http://obo.cvs.sourceforge.net/*checkout*/obo/obo/ontology/phenotype/unit.obo"/>
	</cvList>
	<InputFiles>
		<RawFilesGroup id="raw1">
			<RawFile location="../data/4045.raw" id="r1"/>
		</RawFilesGroup>
		<RawFilesGroup id="raw2">
			<RawFile location="../data/4046.raw" id="r2"/>
		</RawFilesGroup>
		<IdentificationFiles>
			<IdentificationFile location="./data/4045.mzid" id="id_file1"/>
			<IdentificationFile location="./data/4046.mzid" id="id_file2"/>
		</IdentificationFiles>
		<SearchDatabase location="c:\mydb.fasta" id="SD1">
			<DatabaseName>
				<userParam name="mydb.fasta"/>
			</DatabaseName>
		</SearchDatabase>
	</InputFiles>
	<AssayList id="AssayList1">
		<Assay id="B1" name="B1">
			<raw_files_group_ref>raw1</raw_files_group_ref>
			<Label>
				<Modification massDelta="6">
					<cvParam cvRef="" accession="" name=""/>
				</Modification>
			</Label>
		</Assay>
		<Assay id="E1" name="E1_heavy">
			<raw_files_group_ref>raw1</raw_files_group_ref>
			<Label>
				<Modification massDelta="12">
					<cvParam cvRef="" accession="" name=""/>
				</Modification>
			</Label>
		</Assay>
		<Assay id="B2" name="B2">
			<raw_files_group_ref>raw2</raw_files_group_ref>
			<Label>
				<Modification massDelta="6">
					<cvParam cvRef="" accession="" name=""/>
				</Modification>
			</Label>
		</Assay>
		<Assay id="E2" name="E2_heavy">
			<raw_files_group_ref>raw2</raw_files_group_ref>
			<Label>
				<Modification massDelta="12">
					<cvParam cvRef="" accession="" name=""/>
				</Modification>
			</Label>
		</Assay>
	</AssayList>
	<StudyVariableList>
		<StudyVariable id="SV_group_B" name="Group B">
			<cvParam accession="MS:0000000 (study variable)" name="concentration" cvRef="PSI-MS" value="1" unitAccession="TODO" unitCvRef="TODO" unitName="TODO"/>
			<AssayRef assay_ref="B1"/>
			<AssayRef assay_ref="B2"/>
		</StudyVariable>
		<StudyVariable id="SV_group_E" name="Group E">
			<cvParam accession="MS:0000000 (study variable)" name="concentration" cvRef="PSI-MS" value="10" unitAccession="TODO" unitCvRef="TODO" unitName="TODO"/>
			<AssayRef assay_ref="E1"/>
			<AssayRef assay_ref="E2"/>		
		</StudyVariable>
	</StudyVariableList>
	
	<RatioList>
		<Ratio id="ratioE_B" numerator_ref="SV_group_E" denominator_ref="SV_group_B">
			<RatioCalculation>
				<userParam name="Simple ratio calc"/>
			</RatioCalculation>
		</Ratio>
		<Ratio numerator_ref="E1" denominator_ref="B1" id="E1_over_B1"/>
		<Ratio numerator_ref="E2" denominator_ref="B2" id="E2_over_B2"/>
	</RatioList>

	<AnalysisSummary>
		<cvParam cvRef="PSI-MS" accession="" name="ICPL"/>
		<cvParam cvRef="PSI-MS" accession="" name="Number of proteins quantified" value="1"/>
		<!-- Global params and values go in here -->
	</AnalysisSummary>

	<ProteinList>
		<!-- Note, it needs some thought as to whether to allow different sets of peptide_refs for each assay or study variable. This will increase the complexity of the format, but some exporters may want this -->
		<Protein id="P02769" accession="P02769">
			<peptide_refs>DAFLGSFYEYR KQTALVELLK</peptide_refs>
		</Protein>
		<StudyVariableQuantLayer id="SV_ratio">
			<DataType>
				<cvParam accession="" name="" cvRef=""></cvParam>
			</DataType>
			<ColumnIndex>ratioE_B</ColumnIndex>
			<DataMatrix>
				<Row object_ref="P02769">1.91</Row>
			</DataMatrix>
		</StudyVariableQuantLayer>
		
		<RatioQuantLayer id="QL_protein_ratio">
			<DataType>
				<cvParam cvRef="" accession="" name="ratio"/>
			</DataType>
			<ColumnIndex>E1_over_B1 E2_over_B2</ColumnIndex>
			<DataMatrix>
				<Row object_ref="P02769">1.83 2</Row>
			</DataMatrix>
		</RatioQuantLayer>
	</ProteinList>
	<PeptideList>
		<Peptide id="DAFLGSFYEYR">
			<PeptideSequence>DAFLGSFYEYR</PeptideSequence>
			<!-- If feature refs are used, is allowed to have more than one feature from the same assay -->
			<matched_feature_refs>MF1</matched_feature_refs>
		</Peptide>
		<Peptide id="KQTALVELLK">
			<PeptideSequence>KQTALVELLK</PeptideSequence>
			<matched_feature_refs>MF2</matched_feature_refs>
		</Peptide>
		<RatioQuantLayer id="QL_ratio_across_study_variables">
			<DataType>
				<cvParam cvRef="PSI-MS" accession="TODO" name="Ratio abundance"/>
			</DataType>
			<ColumnIndex>E1_over_B1 E2_over_B2</ColumnIndex>
			<DataMatrix>
				<Row object_ref="DAFLGSFYEYR">1.39 1.83</Row>
				<Row object_ref="KQTALVELLK">1.73 1.90</Row>
			</DataMatrix>
		</RatioQuantLayer>
	</PeptideList>
	<FeatureList RawFileGroup_ref="raw1">
		<Feature id="featureB1_1" charge="2" MZ="836.8857245" RT="103.41250773"/>
		<Feature id="featureB1_3" charge="2" MZ="836.8857245" RT="103.21965813"/>
		<Feature id="featureB1_4" charge="2" MZ="729.3929875" RT="101.961416"/>
		<Feature id="featureE1_1" charge="2" MZ="839.8957955" RT="103.78063307"/>
		<FeatureQuantLayer id="FQL1">
			<ColumnIndex>
				<Column index="0" processingStep_ref="feature_quantification">
					<DataType>
						<cvParam cvRef="PSI-MS" accession="TODO" name="intensity"/>
					</DataType>
				</Column>
				<Column index="1" processingStep_ref="feature_quantification">
					<DataType>
						<cvParam cvRef="PSI-MS" accession="TODO" name="raw abundance"/>
					</DataType>
				</Column>
				<Column index="2" processingStep_ref="feature_quantification">
					<DataType>
						<cvParam cvRef="PSI-MS" accession="TODO" name="S/N"/>
					</DataType>
				</Column>
			</ColumnIndex>
			<DataMatrix>
				<Row object_ref="featureB1_1">35703868.8083188 0.0 31.4</Row>
				<Row object_ref="featureB1_3">35703868.8083188 0.0 18.5</Row>
				<Row object_ref="featureB1_4">10672038.2173103 0.0 24.6</Row>
				<Row object_ref="featureE1_1">25632317.7094254 0.0 10.6</Row>
			</DataMatrix>
		</FeatureQuantLayer>
	</FeatureList>
	<!-- Raw features quantified from the second raw file-->
	<FeatureList RawFileGroup_ref="raw2">
		<Feature id="featureB2_2" charge="2" MZ="729.3929875" RT="27.8685"/>
		<Feature id="featureB2_5" charge="2" MZ="836.8857245" RT="181.58942453"/>
		<Feature id="featureE2_2" charge="2" MZ="732.4001855" RT="27.8031"/>
		<FeatureQuantLayer id="FQL2">
			<ColumnIndex>
				<Column index="0" processingStep_ref="feature_quantification">
					<DataType>
						<cvParam cvRef="PSI-MS" accession="TODO" name="intensity"/>
					</DataType>
				</Column>
				<Column index="1" processingStep_ref="feature_quantification">
					<DataType>
						<cvParam cvRef="PSI-MS" accession="TODO" name="raw abundance"/>
					</DataType>
				</Column>
				<Column index="2" processingStep_ref="feature_quantification">
					<DataType>
						<cvParam cvRef="PSI-MS" accession="TODO" name="S/N"/>
					</DataType>
				</Column>
			</ColumnIndex>
			<DataMatrix>
				<Row object_ref="featureB2_2">13903788.2517015 -1.0 24.3</Row>
				<Row object_ref="featureB2_5">54054245.586112 -1.0 83.1</Row>
				<Row object_ref="featureE2_2">3213940.59416825 -1.0 -1.0</Row>
			</DataMatrix>
		</FeatureQuantLayer>
	</FeatureList>
	<!-- Do we want to allow multiple MatchedFeatureList, similar to FeatureList -->
	<MatchedFeatureList>
		<!-- Peak pair matching in the first raw file -->
		<MatchedFeature id="MF1">
			<feature_refs>featureB1_1 featureE1_1</feature_refs>
		<!--	<assay_refs>B1 E1</assay_refs> -->
		</MatchedFeature>
		<!-- Peak pair matching in the second raw file -->
		<MatchedFeature id="MF2">
			<feature_refs>featureB2_2 featureE2_2</feature_refs>
		<!--	<assay_refs>B2 E2</assay_refs>	 -->		
		</MatchedFeature>
		<!-- QL containing ratios within single raw file -->
		<RatioQuantLayer id="QL_rawfile1_icpl_pair_ratios">
			<DataType>
				<cvParam cvRef="" accession="" name="ratio"/>
			</DataType>
			<ColumnIndex>E1_over_B1</ColumnIndex>
			<DataMatrix>
				<Row object_ref="MF1">1.83</Row>
				<Row object_ref="MF2">-1.0</Row>				
				<!-- repasar ratios -->
			</DataMatrix>
		</RatioQuantLayer>
		<RatioQuantLayer id="QL_rawfile2_icpl_pair_ratios">
			<DataType>
				<cvParam cvRef="" accession="" name="ratio"/>
			</DataType>
			<ColumnIndex>E2_over_B2</ColumnIndex>
			<DataMatrix>
				<Row object_ref="MF1">-1.0</Row>
				<Row object_ref="MF2">2.0</Row>
				<!-- repasar ratios -->
			</DataMatrix>
		</RatioQuantLayer>
		<!-- Optional to have quant layer or not, not necessarily needed if features have intensity -->
	</MatchedFeatureList>
	
	<SoftwareList>
		<software version="" id="sw1">
			<cvParam accession="" name="" cvRef=""/>
		</software>
	</SoftwareList>
	
	<DataProcessingList>
		<DataProcessing id="feature_quantification">
			<ProcessingMethod softwareRef="sw1" order="1">
				<userParam name=""/>
				<!-- TODO: further describtion of the alignment. maybe even collecting all vectors, if this is intended? -->
			</ProcessingMethod>
		</DataProcessing>
	</DataProcessingList>
</mzQuantML>
